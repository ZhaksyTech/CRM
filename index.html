<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zhaksytech Mini CRM</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2e7bff; /* Blue */
            --secondary-color: #1e3a8a; /* Darker Blue */
            --accent-color: #f59e0b; /* Amber */
            --bg-light: #f3f4f6;
            --text-dark: #1f2937;
            --text-light: #f9fafb;
            --border-color: #d1d5db;
            --success-color: #10b981;
            --error-color: #ef4444;
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            background-color: var(--text-light);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 1000px;
            box-sizing: border-box;
            margin-bottom: 30px;
        }

        h1 {
            text-align: center;
            color: var(--secondary-color);
            margin-bottom: 25px;
            font-size: 2.5em;
            font-weight: 700;
        }

        h2 {
            color: var(--primary-color);
            margin-top: 30px;
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 600;
        }

        .form-section, .list-section {
            margin-bottom: 25px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 10px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: calc(100% - 20px);
            padding: 12px 10px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1em;
            color: var(--text-dark);
            background-color: #fff;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        button {
            background-color: var(--primary-color);
            color: var(--text-light);
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        button:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: flex-end; /* Align buttons to the right */
            margin-top: 20px;
        }

        .clear-data-btn {
            background-color: var(--error-color);
        }

        .clear-data-btn:hover {
            background-color: #dc2626;
        }

        .warning-message {
            background-color: #fef2f2; /* Red-100 */
            color: var(--error-color);
            border: 1px solid var(--error-color);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
            font-size: 0.95em;
        }

        .table-container {
            overflow-x: auto;
        }

        .crm-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .crm-table th, .crm-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            text-align: left;
        }

        .crm-table th {
            background-color: var(--primary-color);
            color: var(--text-light);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9em;
        }

        .crm-table tbody tr:nth-child(even) {
            background-color: #f9fafb;
        }

        .crm-table tbody tr:hover {
            background-color: #eff6ff; /* Blue-50 */
        }

        .crm-table .actions button {
            padding: 8px 12px;
            font-size: 0.9em;
            margin-right: 8px;
        }

        .edit-btn {
            background-color: var(--accent-color);
        }

        .edit-btn:hover {
            background-color: #d97706;
        }

        .delete-btn {
            background-color: var(--error-color);
        }

        .delete-btn:hover {
            background-color: #dc2626;
        }

        .stage-filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .stage-filter-group button {
            background-color: #e0e7ff; /* Lighter blue */
            color: var(--secondary-color);
            border: 1px solid var(--primary-color);
            padding: 8px 15px;
            font-size: 0.95em;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .stage-filter-group button:hover {
            background-color: var(--primary-color);
            color: var(--text-light);
        }

        .stage-filter-group button.active {
            background-color: var(--primary-color);
            color: var(--text-light);
            border-color: var(--primary-color);
            font-weight: 600;
        }

        footer {
            margin-top: 40px;
            text-align: center;
            font-size: 0.85em;
            color: #6b7280;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            .button-group {
                flex-direction: column;
                gap: 10px;
            }
            button {
                width: 100%;
            }
            .stage-filter-group {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🚀 Zhaksytech Mini CRM</h1>
        <p class="warning-message">
            <strong>Important:</strong> This is a client-side prototype. All data is stored only in your browser's local storage. It is NOT shared with anyone else and will be lost if your browser's local storage is cleared. This is not a substitute for a full, secure CRM system.
        </p>

        <div class="form-section">
            <h2>Add New Client/Lead</h2>
            <form id="clientForm">
                <input type="hidden" id="clientId">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="name">Client Name:</label>
                        <input type="text" id="name" required placeholder="e.g., Almas Saparov">
                    </div>
                    <div class="form-group">
                        <label for="company">Company:</label>
                        <input type="text" id="company" placeholder="e.g., Astana Innovations">
                    </div>
                    <div class="form-group">
                        <label for="contactInfo">Contact Info:</label>
                        <input type="text" id="contactInfo" required placeholder="e.g., @almas_tech (Telegram), +77771234567">
                    </div>
                    <div class="form-group">
                        <label for="stage">Pipeline Stage:</label>
                        <select id="stage" required>
                            <option value="New Lead">1. New Lead</option>
                            <option value="Initial Outreach">2. Initial Outreach</option>
                            <option value="Discovery/Qualifying">3. Discovery/Qualifying</option>
                            <option value="Proposal Sent">4. Proposal Sent</option>
                            <option value="Negotiation/Follow-up">5. Negotiation/Follow-up</option>
                            <option value="Won">6. Won (Project Started)</option>
                            <option value="Lost">7. Lost (Reason: ...)</option>
                            <option value="Project Delivered">8. Project Delivered</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="notes">Notes:</label>
                    <textarea id="notes" placeholder="Any specific details, requirements, or next steps."></textarea>
                </div>
                <div class="button-group">
                    <button type="submit" id="submitBtn">➕ Add Client</button>
                    <button type="button" id="clearFormBtn" style="background-color: #6b7280;">Clear Form</button>
                </div>
            </form>
        </div>

        <div class="list-section">
            <h2>Your Clients & Leads</h2>
            <div class="stage-filter-group" id="stageFilters">
                <button class="active" data-stage="All">All Stages</button>
                <button data-stage="New Lead">New Leads</button>
                <button data-stage="Initial Outreach">Outreach</button>
                <button data-stage="Discovery/Qualifying">Discovery</button>
                <button data-stage="Proposal Sent">Proposal Sent</button>
                <button data-stage="Negotiation/Follow-up">Negotiation</button>
                <button data-stage="Won">Won</button>
                <button data-stage="Lost">Lost</button>
                <button data-stage="Project Delivered">Delivered</button>
            </div>
            <div class="table-container">
                <table class="crm-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Company</th>
                            <th>Contact Info</th>
                            <th>Stage</th>
                            <th>Notes</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="clientList">
                        </tbody>
                </table>
            </div>
            <div class="button-group" style="justify-content: flex-start; margin-top: 30px;">
                <button type="button" class="clear-data-btn" id="clearAllDataBtn">⚠️ Clear All Data</button>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Zhaksytech. Mini CRM Prototype.</p>
        <p>Built with HTML, CSS, and JavaScript. Data is stored locally in your browser.</p>
    </footer>

    <script>
        const CLIENTS_STORAGE_KEY = 'zhaksytech_crm_clients';
        let clients = [];
        let editingClientId = null;
        let currentFilterStage = 'All';

        const clientForm = document.getElementById('clientForm');
        const clientIdInput = document.getElementById('clientId');
        const nameInput = document.getElementById('name');
        const companyInput = document.getElementById('company');
        const contactInfoInput = document.getElementById('contactInfo');
        const stageSelect = document.getElementById('stage');
        const notesInput = document.getElementById('notes');
        const submitBtn = document.getElementById('submitBtn');
        const clearFormBtn = document.getElementById('clearFormBtn');
        const clientListBody = document.getElementById('clientList');
        const clearAllDataBtn = document.getElementById('clearAllDataBtn');
        const stageFilters = document.getElementById('stageFilters');

        // --- Data Handling ---
        function loadClients() {
            const storedClients = localStorage.getItem(CLIENTS_STORAGE_KEY);
            clients = storedClients ? JSON.parse(storedClients) : [];
            renderClients();
        }

        function saveClients() {
            localStorage.setItem(CLIENTS_STORAGE_KEY, JSON.stringify(clients));
        }

        // --- UI Rendering ---
        function renderClients() {
            clientListBody.innerHTML = ''; // Clear current list
            const filteredClients = clients.filter(client => 
                currentFilterStage === 'All' || client.stage === currentFilterStage
            );

            if (filteredClients.length === 0) {
                clientListBody.innerHTML = `<tr><td colspan="6" style="text-align: center; padding: 20px;">No clients found in this stage.</td></tr>`;
                return;
            }

            filteredClients.forEach(client => {
                const row = clientListBody.insertRow();
                row.dataset.id = client.id; // Store ID on the row for easy access

                row.innerHTML = `
                    <td>${client.name}</td>
                    <td>${client.company}</td>
                    <td>${client.contactInfo}</td>
                    <td>${client.stage}</td>
                    <td>${client.notes.length > 50 ? client.notes.substring(0, 50) + '...' : client.notes}</td>
                    <td class="actions">
                        <button class="edit-btn" onclick="editClient('${client.id}')">Edit</button>
                        <button class="delete-btn" onclick="deleteClient('${client.id}')">Delete</button>
                    </td>
                `;
            });
        }

        function clearForm() {
            clientIdInput.value = '';
            nameInput.value = '';
            companyInput.value = '';
            contactInfoInput.value = '';
            stageSelect.value = 'New Lead';
            notesInput.value = '';
            submitBtn.textContent = '➕ Add Client';
            editingClientId = null;
        }

        // --- Event Handlers ---
        clientForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const clientData = {
                id: clientIdInput.value || crypto.randomUUID(), // Generate new ID if not editing
                name: nameInput.value.trim(),
                company: companyInput.value.trim(),
                contactInfo: contactInfoInput.value.trim(),
                stage: stageSelect.value,
                notes: notesInput.value.trim()
            };

            if (editingClientId) {
                // Update existing client
                const index = clients.findIndex(c => c.id === editingClientId);
                if (index !== -1) {
                    clients[index] = clientData;
                }
            } else {
                // Add new client
                clients.push(clientData);
            }

            saveClients();
            clearForm();
            renderClients();
        });

        clearFormBtn.addEventListener('click', clearForm);

        clearAllDataBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to clear ALL client data? This action cannot be undone!')) {
                clients = [];
                saveClients();
                renderClients();
                clearForm();
            }
        });

        stageFilters.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                // Remove active class from all buttons
                stageFilters.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
                // Add active class to the clicked button
                e.target.classList.add('active');
                
                currentFilterStage = e.target.dataset.stage;
                renderClients();
            }
        });

        // --- CRUD Operations ---
        function editClient(id) {
            const client = clients.find(c => c.id === id);
            if (client) {
                clientIdInput.value = client.id;
                nameInput.value = client.name;
                companyInput.value = client.company;
                contactInfoInput.value = client.contactInfo;
                stageSelect.value = client.stage;
                notesInput.value = client.notes;

                submitBtn.textContent = '💾 Update Client';
                editingClientId = client.id;
                // Scroll to form for easier editing on mobile
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function deleteClient(id) {
            if (confirm('Are you sure you want to delete this client?')) {
                clients = clients.filter(client => client.id !== id);
                saveClients();
                renderClients();
                // If the deleted client was being edited, clear the form
                if (editingClientId === id) {
                    clearForm();
                }
            }
        }

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', loadClients);
    </script>
</body>
</html>
